<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Rapidjson | Leaning Computer Science Journey</title><meta name="author" content="John Jeep"><meta name="copyright" content="John Jeep"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. rapidjson 2. 基础用法 2.1. 是什么 2.2. 特征 2.3. 怎么用 2.3.1. 解析 2.3.2. 创建   2.4. 注意事项 2.5. 查询 Value 2.5.1. 查询 Array 2.5.2. 查询 Object 2.5.3. 查询 String     3. 内部原理 3.1. Reader 3.2. Writer 3.3. Document 3.4.">
<meta property="og:type" content="article">
<meta property="og:title" content="Rapidjson">
<meta property="og:url" content="https://johnjeep.github.io/OpenSource/OpenSource/Rapidjson/index.html">
<meta property="og:site_name" content="Leaning Computer Science Journey">
<meta property="og:description" content="1. rapidjson 2. 基础用法 2.1. 是什么 2.2. 特征 2.3. 怎么用 2.3.1. 解析 2.3.2. 创建   2.4. 注意事项 2.5. 查询 Value 2.5.1. 查询 Array 2.5.2. 查询 Object 2.5.3. 查询 String     3. 内部原理 3.1. Reader 3.2. Writer 3.3. Document 3.4.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://johnjeep.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-04-04T12:24:00.000Z">
<meta property="article:modified_time" content="2025-04-04T12:24:27.305Z">
<meta property="article:author" content="John Jeep">
<meta property="article:tag" content="openSource">
<meta property="article:tag" content="rapidjson">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://johnjeep.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Rapidjson",
  "url": "https://johnjeep.github.io/OpenSource/OpenSource/Rapidjson/",
  "image": "https://johnjeep.github.io/img/butterfly-icon.png",
  "datePublished": "2025-04-04T12:24:00.000Z",
  "dateModified": "2025-04-04T12:24:27.305Z",
  "author": [
    {
      "@type": "Person",
      "name": "John Jeep",
      "url": "https://johnjeep.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://johnjeep.github.io/OpenSource/OpenSource/Rapidjson/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: John Jeep","link":"链接: ","source":"来源: Leaning Computer Science Journey","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Rapidjson',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">262</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">289</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">56</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"></a><a class="nav-page-title" href="/"><span class="site-name">Rapidjson</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Rapidjson</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-04T12:24:00.000Z" title="发表于 2025-04-04 20:24:00">2025-04-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-04T12:24:27.305Z" title="更新于 2025-04-04 20:24:27">2025-04-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/OpenSource/">OpenSource</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><!-- TOC -->

<ul>
<li><a href="#1-rapidjson">1. rapidjson</a></li>
<li><a href="#2-%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95">2. 基础用法</a><ul>
<li><a href="#21-%E6%98%AF%E4%BB%80%E4%B9%88">2.1. 是什么</a></li>
<li><a href="#22-%E7%89%B9%E5%BE%81">2.2. 特征</a></li>
<li><a href="#23-%E6%80%8E%E4%B9%88%E7%94%A8">2.3. 怎么用</a><ul>
<li><a href="#231-%E8%A7%A3%E6%9E%90">2.3.1. 解析</a></li>
<li><a href="#232-%E5%88%9B%E5%BB%BA">2.3.2. 创建</a></li>
</ul>
</li>
<li><a href="#24-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">2.4. 注意事项</a></li>
<li><a href="#25-%E6%9F%A5%E8%AF%A2-value">2.5. 查询 Value</a><ul>
<li><a href="#251-%E6%9F%A5%E8%AF%A2-array">2.5.1. 查询 Array</a></li>
<li><a href="#252-%E6%9F%A5%E8%AF%A2-object">2.5.2. 查询 Object</a></li>
<li><a href="#253-%E6%9F%A5%E8%AF%A2-string">2.5.3. 查询 String</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3-%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86">3. 内部原理</a><ul>
<li><a href="#31-reader">3.1. Reader</a></li>
<li><a href="#32-writer">3.2. Writer</a></li>
<li><a href="#33-document">3.3. Document</a></li>
<li><a href="#34-value">3.4. Value</a></li>
<li><a href="#35-allocator">3.5. Allocator</a></li>
</ul>
</li>
<li><a href="#4-reference">4. Reference</a></li>
</ul>
<!-- /TOC -->


<h1 id="1-rapidjson"><a href="#1-rapidjson" class="headerlink" title="1. rapidjson"></a>1. rapidjson</h1><h1 id="2-基础用法"><a href="#2-基础用法" class="headerlink" title="2. 基础用法"></a>2. 基础用法</h1><h2 id="2-1-是什么"><a href="#2-1-是什么" class="headerlink" title="2.1. 是什么"></a>2.1. 是什么</h2><p>rapidjson 是腾讯的开源 Json解析框架，用 C++ 代码实现，用于解析和生成 JSON 由于全部代码仅用头文件实现，因此很容易集成在项目中。根据其作者 Milo Yipz 所做的比较，可以看出 rapidjson 的性能非常可观。通过使用 DOM（Document Object Model）可以很方便的将 Json 转化成 DOM，然后查询修改，再转化为一个 Json。通过 rapidjson 库，可以方便我们进行参数的传递，解析的工作。Json 非常便捷的支持键值对、数组、以及深入的嵌套，在编写程序时，可以帮助我们聚焦于业务，而对于参数的传递，则可以较少的投入精力。</p>
<h2 id="2-2-特征"><a href="#2-2-特征" class="headerlink" title="2.2. 特征"></a>2.2. 特征</h2><p>优点</p>
<ul>
<li><p>RapidJSON 库仅由头文件组成，只需把头文件复制至你的项目中。</p>
</li>
<li><p>独立、最小依赖。不需依赖 STL、Boost 库等。</p>
</li>
<li><p>没使用 C++ 异常、RTTI。</p>
</li>
<li><p>支持跨平台。</p>
<p>编译器：Visual Studio、gcc、clang 等<br>架构：x86、x64、ARM 等<br>操作系统：Windows、Mac OS X、Linux、iOS、Android 等</p>
</li>
<li><p>RapidJSON 解析和生成速度快。使用模版及内联函数去降低函数调用开销。内部经优化的 Grisu2 及浮点数解析实现。</p>
</li>
<li><p>RapidJSON 是一个C++ 的 JSON 解析器及生成器，它的灵感来自 RapidXml</p>
</li>
<li><p>RapidJSON 对 Unicode 友好。它支持 UTF-8、UTF-16、UTF-32 (大端序／小端序)，并内部支持这些编码的检测、校验及转码。</p>
<p>例如，RapidJSON 可以在分析一个 UTF-8 文件至 DOM 时，把当中的 JSON 字符串转码至 UTF-16。它也支持代理对（surrogate pair）及 ”\u0000”（空字符），这些特征使得我们，可以很好的把 rapidjson 集成到项目代码之中，提高开发的效率。</p>
</li>
</ul>
<p>缺点</p>
<ul>
<li>RapidJSON 库较难使用，源码使用了大量的模板类和模板函数。</li>
<li>RapidJSON 库的 SAX 风格接口较难使用，因此使用 DOM 接口即可。</li>
</ul>
<h2 id="2-3-怎么用"><a href="#2-3-怎么用" class="headerlink" title="2.3. 怎么用"></a>2.3. 怎么用</h2><p>Rapidjson <a target="_blank" rel="noopener" href="https://rapidjson.org/zh-cn/md_doc_tutorial_8zh-cn.html">官网</a> 非常详细的介绍了如何去使用，自己就不再把官方的文档般到这里来了。只总结一些使用的心得。</p>
<h3 id="2-3-1-解析"><a href="#2-3-1-解析" class="headerlink" title="2.3.1. 解析"></a>2.3.1. 解析</h3><p>json 字符串</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> json = <span class="string">&quot;&#123;\&quot;Info\&quot;:[&#123;\&quot;lots\&quot;:10,\&quot;order_algorithm\&quot;:\&quot;01\&quot;,\&quot;buy_close\&quot;:9000,\&quot;spread_shift\&quot;:0,\&quot;position_b_sell\&quot;:0,\</span></span><br><span class="line"><span class="string">\&quot;position_a_buy_today\&quot;:0,\&quot;position_a_buy_yesterday\&quot;:0,\&quot;sell_open\&quot;:-9000,\&quot;list_instrument_id\&quot;:[\&quot;rb1705\&quot;,\&quot;rb1701\&quot;],\</span></span><br><span class="line"><span class="string">\&quot;position_b_buy_today\&quot;:0,\&quot;buy_open\&quot;:-9000,\&quot;position_a_sell_yesterday\&quot;:0,\&quot;strategy_id\&quot;:\&quot;02\&quot;,\&quot;position_b_buy\&quot;:0,\</span></span><br><span class="line"><span class="string">\&quot;a_wait_price_tick\&quot;:1,\&quot;trade_model\&quot;:\&quot;boll_reversion\&quot;,\&quot;b_wait_price_tick\&quot;:0,\&quot;sell_close\&quot;:9000,\&quot;only_close\&quot;:0,\</span></span><br><span class="line"><span class="string">\&quot;order_action_limit\&quot;:400,\&quot;is_active\&quot;:1,\&quot;lots_batch\&quot;:1,\&quot;position_a_sell\&quot;:0,\&quot;position_b_buy_yesterday\&quot;:0,\</span></span><br><span class="line"><span class="string">\&quot;user_id\&quot;:\&quot;063802\&quot;,\&quot;position_a_buy\&quot;:0,\&quot;trader_id\&quot;:\&quot;1601\&quot;,\&quot;position_a_sell_today\&quot;:0,\&quot;stop_loss\&quot;:0,\</span></span><br><span class="line"><span class="string">\&quot;position_b_sell_today\&quot;:0,\&quot;position_b_sell_yesterday\&quot;:0,\&quot;on_off\&quot;:0&#125;,&#123;\&quot;lots\&quot;:20,\&quot;order_algorithm\&quot;:\&quot;02\&quot;,\</span></span><br><span class="line"><span class="string">\&quot;buy_close\&quot;:9000,\&quot;spread_shift\&quot;:0,\&quot;position_b_sell\&quot;:0,\&quot;position_a_buy_today\&quot;:0,\&quot;position_a_buy_yesterday\&quot;:0,\</span></span><br><span class="line"><span class="string">\&quot;sell_open\&quot;:-9000,\&quot;list_instrument_id\&quot;:[\&quot;ni1705\&quot;,\&quot;ni1701\&quot;],\&quot;position_b_buy_today\&quot;:0,\&quot;buy_open\&quot;:-9000,\</span></span><br><span class="line"><span class="string">\&quot;position_a_sell_yesterday\&quot;:0,\&quot;strategy_id\&quot;:\&quot;01\&quot;,\&quot;position_b_buy\&quot;:0,\&quot;a_wait_price_tick\&quot;:1,\&quot;trade_model\&quot;:\&quot;boll_reversion\&quot;,\</span></span><br><span class="line"><span class="string">\&quot;b_wait_price_tick\&quot;:0,\&quot;sell_close\&quot;:9000,\&quot;only_close\&quot;:0,\&quot;order_action_limit\&quot;:400,\&quot;is_active\&quot;:1,\&quot;lots_batch\&quot;:1,\</span></span><br><span class="line"><span class="string">\&quot;position_a_sell\&quot;:0,\&quot;position_b_buy_yesterday\&quot;:0,\&quot;user_id\&quot;:\&quot;063802\&quot;,\&quot;position_a_buy\&quot;:0,\&quot;trader_id\&quot;:\&quot;1601\&quot;,\</span></span><br><span class="line"><span class="string">\&quot;position_a_sell_today\&quot;:0,\&quot;stop_loss\&quot;:0,\&quot;position_b_sell_today\&quot;:0,\&quot;position_b_sell_yesterday\&quot;:0,\&quot;on_off\&quot;:0&#125;],\</span></span><br><span class="line"><span class="string">\&quot;MsgSendFlag\&quot;:0,\&quot;MsgErrorReason\&quot;:\&quot;IDorpassworderror\&quot;,\&quot;MsgRef\&quot;:1,\&quot;MsgType\&quot;:3,\&quot;MsgResult\&quot;:0&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>代码解析实现</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">rapidjson::Document doc;</span><br><span class="line">doc.<span class="built_in">Parse</span>(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Modify it by DOM.</span></span><br><span class="line">rapidjson::Value&amp; s = doc[<span class="string">&quot;MsgSendFlag&quot;</span>];</span><br><span class="line">s.<span class="built_in">SetInt</span>(s.<span class="built_in">GetInt</span>() + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">rapidjson::Value&amp; infoArray = doc[<span class="string">&quot;Info&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (infoArray.<span class="built_in">IsArray</span>()) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; infoArray.<span class="built_in">Size</span>(); i++) &#123;</span><br><span class="line">        <span class="type">const</span> rapidjson::Value&amp; object = infoArray[i];</span><br><span class="line">        <span class="type">int</span> lots = object[<span class="string">&quot;lots&quot;</span>].<span class="built_in">GetInt</span>();</span><br><span class="line">        std::string order_algorithm = object[<span class="string">&quot;order_algorithm&quot;</span>].<span class="built_in">GetString</span>();</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;int lots = &quot;</span> &lt;&lt; lots &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;string order_algorithm = &quot;</span> &lt;&lt; order_algorithm &lt;&lt; std::endl;</span><br><span class="line">        <span class="type">const</span> rapidjson::Value&amp; info_object = object[<span class="string">&quot;list_instrument_id&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span> (info_object.<span class="built_in">IsArray</span>()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; info_object.<span class="built_in">Size</span>(); j++) &#123;</span><br><span class="line">                std::string instrument = info_object[j].<span class="built_in">GetString</span>();</span><br><span class="line">                std::cout &lt;&lt; <span class="string">&quot;instrument[&quot;</span> &lt;&lt; j &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; instrument &lt;&lt; std::endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Stringify the DOM</span></span><br><span class="line">rapidjson::StringBuffer buffer;</span><br><span class="line"><span class="function">rapidjson::Writer&lt;rapidjson::StringBuffer&gt; <span class="title">writer</span><span class="params">(buffer)</span></span>;</span><br><span class="line">doc.<span class="built_in">Accept</span>(writer);</span><br><span class="line">std::cout &lt;&lt; buffer.<span class="built_in">GetString</span>() &lt;&lt; std::endl;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-创建"><a href="#2-3-2-创建" class="headerlink" title="2.3.2. 创建"></a>2.3.2. 创建</h3><p>组建一个json字符串</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">std::cout &lt;&lt; json &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;|==================|&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;||rapidjson output||&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;|==================|&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">rapidjson::Document doc; <span class="comment">// doc 对象默认类型为 null</span></span><br><span class="line">doc.<span class="built_in">SetObject</span>(); <span class="comment">// 改变类型</span></span><br><span class="line">rapidjson::Document::AllocatorType&amp; allocator = doc.<span class="built_in">GetAllocator</span>();</span><br><span class="line"></span><br><span class="line">doc.<span class="built_in">AddMember</span>(<span class="string">&quot;MsgSendFlag&quot;</span>, <span class="number">1</span>, allocator);</span><br><span class="line">doc.<span class="built_in">AddMember</span>(<span class="string">&quot;MsgErrorReason&quot;</span>, <span class="string">&quot;IDorpassworderror&quot;</span>, allocator);</span><br><span class="line">doc.<span class="built_in">AddMember</span>(<span class="string">&quot;MsgRef&quot;</span>, <span class="number">1</span>, allocator);</span><br><span class="line"></span><br><span class="line"><span class="function">rapidjson::Value <span class="title">info_array</span><span class="params">(rapidjson::kArrayType)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">    <span class="function">rapidjson::Value <span class="title">info_object</span><span class="params">(rapidjson::kObjectType)</span></span>; <span class="comment">// 调用构造函数，参数类型为：json vale type</span></span><br><span class="line">    info_object.<span class="built_in">SetObject</span>();</span><br><span class="line">    info_object.<span class="built_in">AddMember</span>(<span class="string">&quot;lots&quot;</span>, <span class="number">10</span> + i, allocator);</span><br><span class="line">    info_object.<span class="built_in">AddMember</span>(<span class="string">&quot;order_algorithm&quot;</span>, <span class="string">&quot;01&quot;</span>, allocator);</span><br><span class="line"></span><br><span class="line">    <span class="function">rapidjson::Value <span class="title">instrument_array</span><span class="params">(rapidjson::kArrayType)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) &#123;</span><br><span class="line">        <span class="function">rapidjson::Value <span class="title">instrument_object</span><span class="params">(rapidjson::kObjectType)</span></span>;</span><br><span class="line">        instrument_object.<span class="built_in">SetObject</span>();</span><br><span class="line">        instrument_object.<span class="built_in">SetString</span>(<span class="string">&quot;cu1701&quot;</span>);</span><br><span class="line">        instrument_array.<span class="built_in">PushBack</span>(instrument_object, allocator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info_object.<span class="built_in">AddMember</span>(<span class="string">&quot;list_instrument_id&quot;</span>, instrument_array, allocator);</span><br><span class="line">    info_array.<span class="built_in">PushBack</span>(info_object, allocator);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doc.<span class="built_in">AddMember</span>(<span class="string">&quot;Info&quot;</span>, info_array, allocator);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Stringify the DOM</span></span><br><span class="line">rapidjson::StringBuffer buffer; <span class="comment">// 输出流，它分配一个内存缓冲区，供写入整个 JSON</span></span><br><span class="line"><span class="function">rapidjson::Writer&lt;rapidjson::StringBuffer&gt; <span class="title">writer</span><span class="params">(buffer)</span></span>;</span><br><span class="line">doc.<span class="built_in">Accept</span>(writer);</span><br><span class="line">std::cout &lt;&lt; buffer.<span class="built_in">GetString</span>() &lt;&lt; std::endl; <span class="comment">// GetString() 获取缓冲区的内容</span></span><br></pre></td></tr></table></figure>

<h2 id="2-4-注意事项"><a href="#2-4-注意事项" class="headerlink" title="2.4. 注意事项"></a>2.4. 注意事项</h2><ul>
<li><p>RapidJSON 在类型转换时会检查数值的范围。</p>
</li>
<li><p>字符串字面量的优化</p>
<ul>
<li>只储存指针，不作复制</li>
</ul>
</li>
<li><p>优化“短”字符串</p>
<ul>
<li>在 <code>Value</code> 内储存短字符串，无需额外分配。</li>
<li>对 UTF-8 字符串来说，32 位架构下可存储最多 11 字符，64 位下 21 字符（x86-64 下 13 字符）。</li>
</ul>
</li>
<li><p>可选地支持 <code>std::string</code>（定义 <code>RAPIDJSON_HAS_STDSTRING=1</code>）</p>
</li>
<li><p>最小化 DOM 的内存开销。</p>
<p>对大部分 32／64 位机器而言，每个 JSON 值只占 16 或 20 字节（不包含字符串）。</p>
</li>
<li><p>支持快速的预设分配器。</p>
<ul>
<li>它是一个堆栈形式的分配器（顺序分配，不容许单独释放，适合解析过程之用）。</li>
<li>使用者也可提供一个预分配的缓冲区。（有可能达至无需 CRT 分配就能解析多个 JSON）</li>
</ul>
</li>
<li><p>部分 C++11 支持</p>
<ul>
<li>右值引用（rvalue reference）</li>
<li>支持 <code>noexcept</code> 修饰符</li>
<li>支持简洁的范围 for 循环</li>
</ul>
</li>
<li><p>Value 赋值使用move语义，而不是 copy 语义。也就是说，拷贝构造和拷贝赋值函数都是用 move 语义实现的。</p>
</li>
<li><p>当 string 的生命周期不足时，Value 应该使用 Copy-string 存储策略，否则 value 无法长期存储字符串。</p>
</li>
<li><p>StringBuffer 是一个简单的输出流，当该缓冲区满溢时会自动增加容量（默认为 256 个字符）。</p>
</li>
<li><p>FileReadStream &#x2F; FileWriteStream，和IStreamWrapper &#x2F; OStreamWrapper，它们都是字节流，不处理编码。若输入流或输出流数据是非 UTF-8 编码时，输入流数据需要用 EncodedInputStream 或AutoUTFInputStream 包装，而输出流数据需要用 EncodedOutputStream 或 AutoUTFOutputStream 包装。</p>
</li>
<li><p><strong>不建议</strong>使用 wistream 和 wostream。</p>
</li>
</ul>
<h2 id="2-5-查询-Value"><a href="#2-5-查询-Value" class="headerlink" title="2.5. 查询 Value"></a>2.5. 查询 Value</h2><h3 id="2-5-1-查询-Array"><a href="#2-5-1-查询-Array" class="headerlink" title="2.5.1. 查询 Array"></a>2.5.1. 查询 Array</h3><p>缺省情况下，<code>SizeType</code> 是 <code>unsigned</code> 的 typedef。在多数系统中，Array 最多能存储 $2^{32}-1$ 个元素。</p>
<p>用法与 <code>std::vector</code> 类似，同时也支持 C++11 的 for 循环迭代。</p>
<h3 id="2-5-2-查询-Object"><a href="#2-5-2-查询-Object" class="headerlink" title="2.5.2. 查询 Object"></a>2.5.2. 查询 Object</h3><ul>
<li><p><code>FindMember()</code>:  检查成员是否存在并返回它的 <code>Value</code>。</p>
<p>用于查询 Object ，比普通的迭代遍历对象要高效。因为当 <code>operator[](const char*)</code> 找不到成员，它会断言失败。若我们不确定一个成员是否存在，便需要在调用 <code>operator[](const char*)</code> 前先调用 <code>HasMember()</code>，这会导致两次查找，降低了效率。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通查询</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span>* kTypeNames[] = </span><br><span class="line">    &#123; <span class="string">&quot;Null&quot;</span>, <span class="string">&quot;False&quot;</span>, <span class="string">&quot;True&quot;</span>, <span class="string">&quot;Object&quot;</span>, <span class="string">&quot;Array&quot;</span>, <span class="string">&quot;String&quot;</span>, <span class="string">&quot;Number&quot;</span> &#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (Value::ConstMemberIterator itr = document.<span class="built_in">MemberBegin</span>();</span><br><span class="line">    itr != document.<span class="built_in">MemberEnd</span>(); ++itr) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Type of member %s is %s\n&quot;</span>,</span><br><span class="line">        itr-&gt;name.<span class="built_in">GetString</span>(), kTypeNames[itr-&gt;value.<span class="built_in">GetType</span>()]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 采用FindMember()</span></span><br><span class="line">Value::ConstMemberIterator itr = document.<span class="built_in">FindMember</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (itr != document.<span class="built_in">MemberEnd</span>()) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, itr-&gt;value.<span class="built_in">GetString</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>rapidjson 为了最大化性能，大量使用了<strong>浅拷贝</strong>，使用之前一定要了解清楚。如果采用了浅拷贝，特别要注意局部对象的使用，以防止对象已被析构了，却还在被使用。</p>
<h3 id="2-5-3-查询-String"><a href="#2-5-3-查询-String" class="headerlink" title="2.5.3. 查询 String"></a>2.5.3. 查询 String</h3><p>RapidJSON 提供两个 String 的存储策略。</p>
<ol>
<li>copy-string: 分配缓冲区，然后把来源数据复制至它。</li>
<li>const-string: 简单地储存字符串的指针。</li>
</ol>
<ul>
<li><p>支持处理包含 <code>\0</code> 的字符。</p>
<p>根据 RFC 4627，JSON String 可包含 Unicode 字符 <code>U+0000</code>，在 JSON 中会表示为 <code>&quot;\u0000&quot;</code>。问题是，C&#x2F;C++ 通常使用空字符结尾字符串（null-terminated string），这种字符串把 <code>‘\0’</code> 作为结束符号。为了符合 RFC 4627，RapidJSON 支持包含 <code>U+0000</code> 的 String。若要获取这种字符串的 长度，调用  <code>GetStringLength()</code> 函数即可。</p>
</li>
<li><p>API</p>
<ul>
<li><code>GetString()</code></li>
<li><code>GetStringLength()</code></li>
</ul>
</li>
</ul>
<h1 id="3-内部原理"><a href="#3-内部原理" class="headerlink" title="3. 内部原理"></a>3. 内部原理</h1><p>简称</p>
<ul>
<li>SAX 是 Simple API for XML 的缩写。</li>
<li>DOM 是 Document Object Model(文件对象模型)的缩写。</li>
</ul>
<p>核心 API。</p>
<ul>
<li>源码路径 <code>include/rapidjson</code> 下有很多的文件，掌握下面几个核心的文件就能用好 rapidjson 常用的功能。<ul>
<li><code>allocators.h</code></li>
<li><code>document.h</code></li>
<li><code>rapidjson.h</code></li>
<li><code>reader.h</code></li>
<li><code>writer.h</code></li>
<li><code>stringbuffer.h</code></li>
</ul>
</li>
</ul>
<h2 id="3-1-Reader"><a href="#3-1-Reader" class="headerlink" title="3.1. Reader"></a>3.1. Reader</h2><p><code>Reader</code>: （<code>GenericReader&lt;...&gt;</code> 的 typedef）是 JSON 的 SAX 风格<strong>解析器</strong>。</p>
<p><code>Reader</code> 从输入流解析一个 JSON。当它从流中读取字符时，它会基于 JSON 的语法去分析字符，并向处理器发送事件。</p>
<p><code>Reader</code> 是 <code>GenericReader</code> 模板类的别名，位于 <code>reader.h</code> 文件中。 </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> rapidjson &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> SourceEncoding, <span class="keyword">typename</span> TargetEncoding, <span class="keyword">typename</span> Allocator = MemoryPoolAllocator&lt;&gt; &gt;</span><br><span class="line"><span class="keyword">class</span> GenericReader &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> GenericReader&lt;UTF8&lt;&gt;, UTF8&lt;&gt; &gt; Reader;</span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// namespace rapidjson</span></span><br></pre></td></tr></table></figure>



<h2 id="3-2-Writer"><a href="#3-2-Writer" class="headerlink" title="3.2. Writer"></a>3.2. Writer</h2><p><code>Writer</code>: （<code>GenericWriter&lt;...&gt;</code> 的 typedef）是 JSON 的 SAX 风格<strong>生成器</strong>。<code>Writer</code> 将数据生成 Json 格式数据。</p>
<p><code>Writer</code> 是一个模板类，而不是一个 typedef，并没有 <code>GenericWriter</code>，位于 <code>writer.h</code> 中。下面是 <code>Write</code> 模板类的声明：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> rapidjson &#123;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> OutputStream, <span class="keyword">typename</span> SourceEncoding = UTF8&lt;&gt;, <span class="keyword">typename</span> TargetEncoding = UTF8&lt;&gt;, <span class="keyword">typename</span> StackAllocator = CrtAllocator, <span class="type">unsigned</span> writeFlags = kWriteDefaultFlags&gt;</span><br><span class="line"><span class="keyword">class</span> Writer &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> SourceEncoding::Ch Ch;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> kDefaultMaxDecimalPlaces = <span class="number">324</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//! Constructor</span></span><br><span class="line">    <span class="comment">/*! \param os Output stream.</span></span><br><span class="line"><span class="comment">        \param stackAllocator User supplied allocator. If it is null, it will create a private one.</span></span><br><span class="line"><span class="comment">        \param levelDepth Initial capacity of stack.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span></span></span><br><span class="line"><span class="function">    <span class="title">Writer</span><span class="params">(OutputStream&amp; os, StackAllocator* stackAllocator = <span class="number">0</span>, <span class="type">size_t</span> levelDepth = kDefaultLevelDepth)</span> : </span></span><br><span class="line"><span class="function">        os_(&amp;os), level_stack_(stackAllocator, levelDepth * sizeof(Level)), maxDecimalPlaces_(kDefaultMaxDecimalPlaces), hasRoot_(false) &#123;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span></span></span><br><span class="line"><span class="function">    <span class="title">Writer</span><span class="params">(StackAllocator* allocator = <span class="number">0</span>, <span class="type">size_t</span> levelDepth = kDefaultLevelDepth)</span> :</span></span><br><span class="line"><span class="function">        os_(<span class="number">0</span>), level_stack_(allocator, levelDepth * sizeof(Level)), maxDecimalPlaces_(kDefaultMaxDecimalPlaces), hasRoot_(false) &#123;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> RAPIDJSON_HAS_CXX11_RVALUE_REFS</span></span><br><span class="line">    <span class="built_in">Writer</span>(Writer&amp;&amp; rhs) :</span><br><span class="line">        <span class="built_in">os_</span>(rhs.os_), <span class="built_in">level_stack_</span>(std::<span class="built_in">move</span>(rhs.level_stack_)), <span class="built_in">maxDecimalPlaces_</span>(rhs.maxDecimalPlaces_), <span class="built_in">hasRoot_</span>(rhs.hasRoot_) &#123;</span><br><span class="line">        rhs.os_ = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成 json 格式的数据有两种方式。</p>
<ol>
<li><p>用字符串缓冲结合 <code>Writer</code>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rapidjson/writer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rapidjson/stringbuffer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> rapidjson;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StringBuffer s;</span><br><span class="line">    <span class="function">Writer&lt;StringBuffer&gt; <span class="title">writer</span><span class="params">(s)</span></span>;</span><br><span class="line">    </span><br><span class="line">    writer.<span class="built_in">StartObject</span>();</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">String</span>(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;t&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">Bool</span>(<span class="literal">true</span>);</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;f&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">Bool</span>(<span class="literal">false</span>);</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;n&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">Null</span>();</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;i&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">Uint</span>(<span class="number">123</span>);</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;pi&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">Double</span>(<span class="number">3.1416</span>);</span><br><span class="line">    writer.<span class="built_in">Key</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    writer.<span class="built_in">StartArray</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        writer.<span class="built_in">Uint</span>(i);</span><br><span class="line">    writer.<span class="built_in">EndArray</span>();</span><br><span class="line">    writer.<span class="built_in">EndObject</span>();</span><br><span class="line"> </span><br><span class="line">    cout &lt;&lt; s.<span class="built_in">GetString</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 输出</span></span><br><span class="line">&#123;<span class="string">&quot;hello&quot;</span>:<span class="string">&quot;world&quot;</span>,<span class="string">&quot;t&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;f&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;n&quot;</span>:null,<span class="string">&quot;i&quot;</span>:<span class="number">123</span>,<span class="string">&quot;pi&quot;</span>:<span class="number">3.1416</span>,<span class="string">&quot;a&quot;</span>:[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>用 <code>Document</code> 类、分配器(Allocator)结合 <code>AddMember()</code> 函数。</p>
</li>
</ol>
<h2 id="3-3-Document"><a href="#3-3-Document" class="headerlink" title="3.3. Document"></a>3.3. Document</h2><p><code>Document</code>: 是模板类 <code>GenericDocument&lt;UTF8&lt;&gt; &gt;</code> 的别名，位于 <code>document.h</code> 文件中。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> rapidjson &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Encoding, <span class="keyword">typename</span> Allocator = RAPIDJSON_DEFAULT_ALLOCATOR, <span class="keyword">typename</span> StackAllocator = RAPIDJSON_DEFAULT_STACK_ALLOCATOR &gt;</span><br><span class="line"><span class="keyword">class</span> GenericDocument : <span class="keyword">public</span> GenericValue&lt;Encoding, Allocator&gt; &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//! GenericDocument with UTF8 encoding</span></span><br><span class="line"><span class="keyword">typedef</span> GenericDocument&lt;UTF8&lt;&gt; &gt; Document;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-4-Value"><a href="#3-4-Value" class="headerlink" title="3.4. Value"></a>3.4. Value</h2><p><code>Value</code>: 是 DOM API 的核心，它是模板类 <code>GenericValue&lt;UTF8&lt;&gt; &gt;</code> 的别名，位于 <code>document.h</code> 中。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> rapidjson &#123;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Encoding, <span class="keyword">typename</span> Allocator = RAPIDJSON_DEFAULT_ALLOCATOR &gt;</span><br><span class="line"><span class="keyword">class</span> GenericValue &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//! GenericValue with UTF8 encoding</span></span><br><span class="line"><span class="keyword">typedef</span> GenericValue&lt;UTF8&lt;&gt; &gt; Value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Value</code> 是一个可变类型。在 RapidJSON 的上下文中，一个 <code>Value</code> 的实例可以包含6种 JSON 数据类型。</p>
<ul>
<li>Null</li>
<li>String</li>
<li>Bool</li>
<li>Object</li>
<li>Array</li>
<li>Number</li>
</ul>
<p>注意点：</p>
<ul>
<li><p>为了减少在64位架构上的内存消耗，<code>SizeType</code> 被定义为 <code>unsigned</code> 而不是 <code>size_t</code>。</p>
</li>
<li><p>32位整数的零填充可能被放在实际类型的前面或后面，这依赖于字节序。这使得它可以将32位整数不经过任何转换就可以解释为64位整数。</p>
</li>
<li><p><code>Int</code> 永远是 <code>Int64</code></p>
</li>
<li><p><code>Handler</code>: 用于处理来自 <code>Reader</code> 的事件（函数调用）。处理器必须包含以下的成员函数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Null</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Bool</span><span class="params">(<span class="type">bool</span> b)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Int</span><span class="params">(<span class="type">int</span> i)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Uint</span><span class="params">(<span class="type">unsigned</span> i)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Int64</span><span class="params">(<span class="type">int64_t</span> i)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Uint64</span><span class="params">(<span class="type">uint64_t</span> i)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Double</span><span class="params">(<span class="type">double</span> d)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">RawNumber</span><span class="params">(<span class="type">const</span> Ch* str, SizeType length, <span class="type">bool</span> copy)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">String</span><span class="params">(<span class="type">const</span> Ch* str, SizeType length, <span class="type">bool</span> copy)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">StartObject</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Key</span><span class="params">(<span class="type">const</span> Ch* str, SizeType length, <span class="type">bool</span> copy)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">EndObject</span><span class="params">(SizeType memberCount)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">StartArray</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">EndArray</span><span class="params">(SizeType elementCount)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-5-Allocator"><a href="#3-5-Allocator" class="headerlink" title="3.5. Allocator"></a>3.5. Allocator</h2><p>Allocator(分配器)，位于 <code>allocators.h</code> 文件中。</p>
<p><code>MemoryPoolAllocator</code> 是 DOM 的默认内存分配器。它只申请内存而不释放内存。这对于构建 DOM 树非常合适。</p>
<p>在它的内部，它从基础的内存分配器申请内存块（默认为 <code>CrtAllocator</code>）并将这些内存块存储为单向链表。当用户请求申请内存，它会遵循下列步骤来申请内存：</p>
<ol>
<li>如果可用，使用用户提供的缓冲区。（见 User Buffer section in DOM）</li>
<li>如果用户提供的缓冲区已满，使用当前内存块。</li>
<li>如果当前内存块已满，申请新的内存块。</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> rapidjson &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CrtAllocator</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">bool</span> kNeedFree = <span class="literal">true</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span>* <span class="title">Malloc</span><span class="params">(<span class="type">size_t</span> size)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (size) <span class="comment">//  behavior of malloc(0) is implementation defined.</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">RAPIDJSON_MALLOC</span>(size);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>; <span class="comment">// standardize to returning NULL.</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span>* <span class="title">Realloc</span><span class="params">(<span class="type">void</span>* originalPtr, <span class="type">size_t</span> originalSize, <span class="type">size_t</span> newSize)</span> </span>&#123;</span><br><span class="line">        (<span class="type">void</span>)originalSize;</span><br><span class="line">        <span class="keyword">if</span> (newSize == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">RAPIDJSON_FREE</span>(originalPtr);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">RAPIDJSON_REALLOC</span>(originalPtr, newSize);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">Free</span><span class="params">(<span class="type">void</span> *ptr)</span> RAPIDJSON_NOEXCEPT </span>&#123; <span class="built_in">RAPIDJSON_FREE</span>(ptr); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> CrtAllocator&amp;) <span class="type">const</span> RAPIDJSON_NOEXCEPT &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>!=(<span class="type">const</span> CrtAllocator&amp;) <span class="type">const</span> RAPIDJSON_NOEXCEPT &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> BaseAllocator = CrtAllocator&gt;</span><br><span class="line"><span class="keyword">class</span> MemoryPoolAllocator &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-Reference"><a href="#4-Reference" class="headerlink" title="4. Reference"></a>4. Reference</h1><ul>
<li>官方 Github: <a target="_blank" rel="noopener" href="https://github.com/Tencent/rapidjson/">https://github.com/Tencent/rapidjson/</a></li>
<li>英文文档: <a target="_blank" rel="noopener" href="https://rapidjson.org/">https://rapidjson.org/</a></li>
<li>中文文档: <a target="_blank" rel="noopener" href="https://rapidjson.org/zh-cn/index.html">https://rapidjson.org/zh-cn/index.html</a></li>
<li>Unicode 字符代码: <a target="_blank" rel="noopener" href="https://www.rapidtables.org/zh-CN/code/text/unicode-characters.html">https://www.rapidtables.org/zh-CN/code/text/unicode-characters.html</a></li>
<li>Unicode 15.0 Character Code Charts: <a target="_blank" rel="noopener" href="https://www.unicode.org/charts/">https://www.unicode.org/charts/</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://johnjeep.github.io">John Jeep</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://johnjeep.github.io/OpenSource/OpenSource/Rapidjson/">https://johnjeep.github.io/OpenSource/OpenSource/Rapidjson/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://johnjeep.github.io" target="_blank">Leaning Computer Science Journey</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/openSource/">openSource</a><a class="post-meta__tags" href="/tags/rapidjson/">rapidjson</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/OpenSource/OpenSource/OpenSourceProject/" title="OpenSourceProject"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">OpenSourceProject</div></div><div class="info-2"><div class="info-item-1">      1. GitHub开源项目 2. C 3. C++ 4. Java 5. 网络 6. Linux 7. Go 8. 数据结构与算法 9. 有价值的开源库 10. 其它      1. GitHub开源项目2. C ip2region：准确率99.9%的离线IP地址定位库，0.0x毫秒级查询 explainshell：解析 Linux 命令的网站 Tinyhttpd：一个不到 500 行的超轻量型 HTTP Server db_tutorial：用 C 从零创建一个简单的数据库 reading-code-of-nginx-1.9.2：nginx源码阅读分析中文注 write-a-hash-table Tutorial - Write a System Call Let’s code a TCP&#x2F;IP stack, 1: Ethernet &amp; ARP Tutorial - Write a Shell in C Writing a Unix Shell libhv：快速的编写 HTTP 客户端&#x2F;服务端，简单易用的非阻塞 IO 事件循环库  3....</div></div></div></a><a class="pagination-related" href="/OpenSource/OpenSource/jq/" title="jq"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">jq</div></div><div class="info-2"><div class="info-item-1">jqIntroductionjq 是 stedolan 开发的一个轻量级的和灵活的命令行 JSON 处理器。 它主要用于在命令行界面处理 JSON 输入，并使用给定的过滤条件来过滤符合条件的新的 JSON 串。 通常在类 Unix 环境下，我们可以快速的使用 jq 来进行 JSON 数据格式化过滤和处理。同时需要注意的是，该命令行工具和 awk&#x2F;sed&#x2F;grep 工具一样，属于系统的默认命令，如果系统没有该命令，可以尝试使用如下方式进行安装。 12345# Ubuntu 系列$ sudo apt-get install jq # CentOS 系列$ yum install jq     Reference 官方文档：https://stedolan.github.io/jq/ 知乎介绍 jq 用法：https://zhuanlan.zhihu.com/p/606945462 个人（上月行）博客介绍 jq 用法：https://shanyue.tech/op/jq.html  </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/OpenSource/OpenSource/JsonCpp/" title="JsonCpp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">JsonCpp</div></div><div class="info-2"><div class="info-item-1">JsonCppon简介JsonCpp是一个序列化反序列JSON格式的开源C++库，被C++程序广泛使用（包括Chromium项目）。JsonCpp还有一个重要特性是其支持在JSON格式内注释，这对于使用JSON格式作为配置文件很有意义，可以给配置添加注释说明其用途。 用法JsonCpp三个核心类 Reader、FastWriter、Value基本可以满足项目对JSON构造解析的要求。  类Reader，用来将一个JSON文件或JSON格式的字符串解析成Value对象。 parse()接口第一个参数为JSON格式字符串，第二个参数是解析后Value对象，如果JSON格式正确将解析成功。  类FastWriter，用来将一个Value对象格式化为JSON格式的字符串。 write()接口的参数是一个Value对象，返回值为JSON格式的字符串。  类Value，是JsonCpp库最为重要的类，它代表JSON格式字符串在内存中的状态，修改JSON格式字符串需先修改其Value对象，然后序列化输出，其提供四类接口：  第一，...</div></div></div></a><a class="pagination-related" href="/OpenSource/OpenSource/License/" title="License"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">License</div></div><div class="info-2"><div class="info-item-1">License 开源许可证MITApache 2.0Apache 2.0 许可证约定  遵循许可的前提下，你可以自由地对代 码进行修改，再发布，可以将代码用作商业用途。 但要求你： 署名：在原有代码和衍生代码中，保留原作者署名及代码来源信息。  保留许可证：在原有代码和衍生代码中，保留 Apache 2.0 协议文件。  </div></div></div></a><a class="pagination-related" href="/OpenSource/OpenSource/OpenSourceProject/" title="OpenSourceProject"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">OpenSourceProject</div></div><div class="info-2"><div class="info-item-1">      1. GitHub开源项目 2. C 3. C++ 4. Java 5. 网络 6. Linux 7. Go 8. 数据结构与算法 9. 有价值的开源库 10. 其它      1. GitHub开源项目2. C ip2region：准确率99.9%的离线IP地址定位库，0.0x毫秒级查询 explainshell：解析 Linux 命令的网站 Tinyhttpd：一个不到 500 行的超轻量型 HTTP Server db_tutorial：用 C 从零创建一个简单的数据库 reading-code-of-nginx-1.9.2：nginx源码阅读分析中文注 write-a-hash-table Tutorial - Write a System Call Let’s code a TCP&#x2F;IP stack, 1: Ethernet &amp; ARP Tutorial - Write a Shell in C Writing a Unix Shell libhv：快速的编写 HTTP 客户端&#x2F;服务端，简单易用的非阻塞 IO 事件循环库  3....</div></div></div></a><a class="pagination-related" href="/OpenSource/OpenSource/jq/" title="jq"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">jq</div></div><div class="info-2"><div class="info-item-1">jqIntroductionjq 是 stedolan 开发的一个轻量级的和灵活的命令行 JSON 处理器。 它主要用于在命令行界面处理 JSON 输入，并使用给定的过滤条件来过滤符合条件的新的 JSON 串。 通常在类 Unix 环境下，我们可以快速的使用 jq 来进行 JSON 数据格式化过滤和处理。同时需要注意的是，该命令行工具和 awk&#x2F;sed&#x2F;grep 工具一样，属于系统的默认命令，如果系统没有该命令，可以尝试使用如下方式进行安装。 12345# Ubuntu 系列$ sudo apt-get install jq # CentOS 系列$ yum install jq     Reference 官方文档：https://stedolan.github.io/jq/ 知乎介绍 jq 用法：https://zhuanlan.zhihu.com/p/606945462 个人（上月行）博客介绍 jq 用法：https://shanyue.tech/op/jq.html  </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">John Jeep</div><div class="author-info-description">lifestyle is lazy, faster, thinking</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">262</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">289</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">56</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JohnJeep/Learning-CS-Journey"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/xxxxx@gmail.com" target="_blank" title="Gmail"><i class="fa-solid fa-bell" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-rapidjson"><span class="toc-number">1.</span> <span class="toc-text">1. rapidjson</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">2. 基础用法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. 是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E7%89%B9%E5%BE%81"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. 特征</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%80%8E%E4%B9%88%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">2.3. 怎么用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-%E8%A7%A3%E6%9E%90"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1. 解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E5%88%9B%E5%BB%BA"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2. 创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">2.4.</span> <span class="toc-text">2.4. 注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E6%9F%A5%E8%AF%A2-Value"><span class="toc-number">2.5.</span> <span class="toc-text">2.5. 查询 Value</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-%E6%9F%A5%E8%AF%A2-Array"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1. 查询 Array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-%E6%9F%A5%E8%AF%A2-Object"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2. 查询 Object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3-%E6%9F%A5%E8%AF%A2-String"><span class="toc-number">2.5.3.</span> <span class="toc-text">2.5.3. 查询 String</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">3. 内部原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Reader"><span class="toc-number">3.1.</span> <span class="toc-text">3.1. Reader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Writer"><span class="toc-number">3.2.</span> <span class="toc-text">3.2. Writer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-Document"><span class="toc-number">3.3.</span> <span class="toc-text">3.3. Document</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-Value"><span class="toc-number">3.4.</span> <span class="toc-text">3.4. Value</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-Allocator"><span class="toc-number">3.5.</span> <span class="toc-text">3.5. Allocator</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-Reference"><span class="toc-number">4.</span> <span class="toc-text">4. Reference</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Learning-CS-Journey/CONVENTION/" title="CONVENTION">CONVENTION</a><time datetime="2025-04-04T12:24:00.000Z" title="发表于 2025-04-04 20:24:00">2025-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Learning-CS-Journey/README/" title="README">README</a><time datetime="2025-04-04T12:24:00.000Z" title="发表于 2025-04-04 20:24:00">2025-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Learning-CS-Journey/STARCHARTS/" title="STARCHARTS">STARCHARTS</a><time datetime="2025-04-04T12:24:00.000Z" title="发表于 2025-04-04 20:24:00">2025-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/AI/AI/AIGC/" title="AIGC">AIGC</a><time datetime="2025-04-04T12:24:00.000Z" title="发表于 2025-04-04 20:24:00">2025-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/AI/AI/ollama/" title="ollama">ollama</a><time datetime="2025-04-04T12:24:00.000Z" title="发表于 2025-04-04 20:24:00">2025-04-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By John Jeep</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>